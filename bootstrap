#!/bin/bash
set -x

dotdir_path="${HOME}/dotfiles"

function Setup.symlink() {
    local target=$1
    local to=${2:-"${HOME}/${target}"}
    ln -sfn ${dotdir_path}/${target} ${to}
}

################################################################################

: 'copy git config file' && {
    Setup.symlink git/gitconfig ~/.gitconfig
    Setup.symlink git/gitignore_global ~/.gitignore_global
}

: 'copy vimrc & gvimrc' && {
    mkdir -p ~/.vim
    mkdir -p ~/.vim/undo
    rm -f ~/.vimrc ~/.gvimrc ~/.viminfo
    Setup.symlink vim/vimrc ~/.vim/vimrc
    Setup.symlink vim/gvimrc ~/.vim/gvimrc
    Setup.symlink vim/snippets ~/.vim/snippets
    Setup.symlink vim/templates ~/.vim/templates
    Setup.symlink vim/ftplugin ~/.vim/ftplugin
    Setup.symlink vim/syntax ~/.vim/syntax
    Setup.symlink vim/ruby ~/.vim/ruby
}

: 'install dein.vim' && [[ ! -e ~/.vim/plugins/repos/github.com/Shougo/dein.vim ]] && {
    git clone https://github.com/Shougo/dein.vim ~/.vim/plugins/repos/github.com/Shougo/dein.vim
}

: 'install zplug' && [[ ! -e ~/.zplug/init.zsh ]] && {
    mkdir -p ~/.zplug
    git clone https://github.com/zplug/zplug ~/.zplug
}

: 'copy zshenv & zshrc, peco-functions' && {
    Setup.symlink zsh/zshenv ~/.zshenv
    Setup.symlink zsh/zshrc ~/.zshrc
    mkdir -p ~/.zsh/site-functions
    Setup.symlink zsh/peco-functions.zsh ~/.zsh/site-functions/peco-functions.zsh
}

: 'copy .tmux.conf' && {
    Setup.symlink .tmux.conf
}

: 'other conig file' && {
    mkdir -p ~/.config/peco
    Setup.symlink etc/peco.json ~/.config/peco/config.json
    Setup.symlink etc/ctags ~/.ctags
    Setup.symlink bin
}
