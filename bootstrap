#!/bin/bash
set -x

dotdir_path="${HOME}/dotfiles"

function Setup.symlink() {
    local target=$1
    local to=${2:-"${HOME}/${target}"}
    ln -sfn ${dotdir_path}/${target} ${to}
}

################################################################################

: 'copy git config file' && {
    Setup.symlink .gitconfig
    Setup.symlink .gitignore_global
}

: 'copy vimrc & gvimrc' && {
    mkdir -p ~/.vim
    rm -f ~/.vimrc ~/.gvimrc ~/.viminfo
    Setup.symlink vim/vimrc ~/.vim/vimrc
    Setup.symlink vim/gvimrc ~/.vim/gvimrc
}

: 'install neobundle & vim plugins' && [[ ! -e ~/.vim/bundle/neobundle.vim ]] && {
    mkdir -p ~/.vim/bundle
    git clone https://github.com/Shougo/vimproc.vim ~/.vim/bundle/vimproc.vim
    (cd ~/.vim/bundle/vimproc.vim && make)
    git clone https://github.com/Shougo/neobundle.vim ~/.vim/bundle/neobundle.vim
}

: 'copy zshenv & zshrc, peco-functions' && {
    Setup.symlink zsh/.zshenv ~/.zshenv
    Setup.symlink zsh/.zshrc ~/.zshrc
    mkdir -p ~/.zsh/site-functions
    Setup.symlink zsh/peco-functions.zsh ~/.zsh/site-functions/peco-functions.zsh
}

: 'copy .tmux.conf' && {
    Setup.symlink .tmux.conf
}
